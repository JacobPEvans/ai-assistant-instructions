name: Documentation Sync

on:
  pull_request:
    types: [opened]

jobs:
  doc-sync:
    name: "Sync Documentation"
    # DISABLED: Workflow is not production ready, and this is a waste of Claude tokens.
    if: false && (github.event.pull_request.head.repo.full_name == github.repository)
    runs-on: ubuntu-latest
    timeout-minutes: 5
    permissions:
      contents: read
      pull-requests: write
      id-token: write
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.ref }}
          fetch-depth: 1
          token: ${{ secrets.GITHUB_TOKEN }}

      - uses: anthropics/claude-code-action@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}

          claude_args: |
            --max-turns 5
            --allowedTools "Read,Bash(gh pr comment:*)"

          prompt: |
            REPO: ${{ github.repository }}
            PR NUMBER: ${{ github.event.pull_request.number }}

            Quick documentation check:
            1. Read PLANNING.md - note if PR title matches any planned tasks
            2. If match found, post comment: "Note: This PR may complete task X in PLANNING.md"
            3. If no match, post: "Docs look good, no conflicts found."

            Keep it simple - just check and comment. No edits needed.
